<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rmcorr">
<title>Reproduce the Results of Repeated Measures Correlation paper • rmcorr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reproduce the Results of Repeated Measures Correlation paper">
<meta property="og:description" content="rmcorr">
<meta property="og:image" content="http://lmarusich.github.io/rmcorr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rmcorr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/FAQ_and_limitations.html">Frequently Asked Questions and Limitations</a>
    <a class="dropdown-item" href="../articles/New_rmcorr_paper_analyses_figures.html">Reproduce the Results of Repeated Measures Correlation paper</a>
    <a class="dropdown-item" href="../articles/rmcorr_mat.html">Plotting with rmcorr_mat</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lmarusich/rmcorr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Reproduce the Results of Repeated Measures Correlation paper</h1>
                        <h4 data-toc-skip class="author">Jonathan
Bakdash and Laura Marusich</h4>
            
            <h4 data-toc-skip class="date">2022-08-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/lmarusich/rmcorr/blob/HEAD/vignettes/New_rmcorr_paper_analyses_figures.Rmd" class="external-link"><code>vignettes/New_rmcorr_paper_analyses_figures.Rmd</code></a></small>
      <div class="d-none name"><code>New_rmcorr_paper_analyses_figures.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="figure-1-rmcorr-and-reg-plot">1. Figure 1: rmcorr and reg plot<a class="anchor" aria-label="anchor" href="#figure-1-rmcorr-and-reg-plot"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># echo = FALSE, warning = FALSE, results =  "hide",</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">initX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">newY</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">newX</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rsq</span> <span class="op">&lt;-</span> <span class="fl">.9</span></span>
<span></span>
<span><span class="va">addx</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">addx</span> <span class="op">&lt;-</span> <span class="va">addx</span> <span class="op">+</span> <span class="fl">.25</span></span>
<span>    <span class="va">tempData</span> <span class="op">&lt;-</span> <span class="va">initX</span><span class="op">[</span><span class="va">sub</span> <span class="op">==</span> <span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">addx</span></span>
<span>    <span class="va">sdx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">tempData</span><span class="op">)</span></span>
<span>    <span class="va">sdnoise</span> <span class="op">&lt;-</span> <span class="va">sdx</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">rsq</span><span class="op">)</span><span class="op">/</span><span class="va">rsq</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">tempy</span> <span class="op">&lt;-</span> <span class="va">tempData</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">0</span>,<span class="va">sdnoise</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="va">newY</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">newY</span>, <span class="va">tempy</span><span class="op">)</span></span>
<span>    <span class="va">newX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">newX</span>,<span class="va">tempData</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">exampleMat</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">sub</span>,<span class="va">newX</span>,<span class="va">newY</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">###standard averaged regression plot</span></span>
<span><span class="va">submeanx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">exampleMat</span><span class="op">$</span><span class="va">newX</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">exampleMat</span><span class="op">$</span><span class="va">sub</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">submeany</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">exampleMat</span><span class="op">$</span><span class="va">newY</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">exampleMat</span><span class="op">$</span><span class="va">sub</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">mypal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">10</span>,<span class="st">'Paired'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu">mypal</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">example.rmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmcorr.html">rmcorr</a></span><span class="op">(</span><span class="va">sub</span>,<span class="va">newX</span>,<span class="va">newY</span>,<span class="va">exampleMat</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in rmcorr(sub, newX, newY, exampleMat): 'sub' coerced into a factor</span></span>
<span></span>
<span><span class="co">#for graphing: get the rmcorr coefficient (rounded) and p-value (using pvals.fct)</span></span>
<span><span class="va">example.rmc.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">example.rmc</span><span class="op">$</span><span class="va">r</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">example.rmc.p</span> <span class="op">&lt;-</span> <span class="fu">pvals.fct</span><span class="op">(</span><span class="va">example.rmc</span><span class="op">$</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#ditto for cor</span></span>
<span><span class="va">stdr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">submeanx</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">submeany</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">example.cor.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">stdr</span><span class="op">$</span><span class="va">estimate</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">example.cor.p</span> <span class="op">&lt;-</span> <span class="fu">pvals.fct</span><span class="op">(</span><span class="va">stdr</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">.75</span>, <span class="fl">0</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">example.rmc</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>     overall <span class="op">=</span> <span class="cn">F</span>, palette <span class="op">=</span> <span class="va">mypal</span>, las <span class="op">=</span> <span class="fl">1</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"A)"</span>, adj <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co">#Removed for Frontiers formatting</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">1.25</span>, <span class="op">-</span><span class="fl">5</span>, adj <span class="op">=</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">r</span><span class="op">[</span><span class="va">rm</span><span class="op">]</span><span class="op">)</span><span class="op">~</span><span class="st">"="</span><span class="op">~</span> <span class="fu">.</span><span class="op">(</span><span class="va">example.rmc.r</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">1.25</span>, <span class="op">-</span><span class="fl">5.75</span>, adj <span class="op">=</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'p'</span><span class="op">)</span><span class="op">~</span><span class="fu">.</span><span class="op">(</span><span class="va">example.rmc.p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">submeanx</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">submeany</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="va">cols</span>, las <span class="op">=</span> <span class="fl">1</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"x (averaged for each participant)"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"y (averaged for each participant)"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>,<span class="fl">6.5</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"B)"</span>, adj <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co">#</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.90</span>, <span class="op">-</span><span class="fl">5</span>, adj <span class="op">=</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'r'</span><span class="op">)</span><span class="op">~</span><span class="st">"="</span><span class="op">~</span> <span class="fu">.</span><span class="op">(</span><span class="va">example.cor.r</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.90</span>, <span class="op">-</span><span class="fl">5.75</span>, adj <span class="op">=</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'p'</span><span class="op">)</span><span class="op">~</span><span class="st">"="</span><span class="op">~</span><span class="fu">.</span><span class="op">(</span><span class="va">example.cor.p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">submeany</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">~</span><span class="va">submeanx</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"gray50"</span><span class="op">)</span></span></code></pre></div>
<p><img src="New_rmcorr_paper_analyses_figures_files/figure-html/unnamed-chunk-2-1.png" width="768"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#(A) Rmcorr plot: rmcorr plot for a set of hypothetical data and (B) simple regression plot: the </span></span>
<span><span class="co">#corresponding regression plot for the same data averaged by participant.</span></span>
<span></span>
<span><span class="co">#dev.copy2eps(file="plots/Figure1_Rmcorr_vs_reg.eps", height = 6, width = 8)</span></span>
<span><span class="co">#dev.copy(pdf, file="plots/Figure1_Rmcorr_vs_reg.pdf", height = 6, width = 8)</span></span>
<span><span class="co">#dev.off()</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="figure-2-rmcorr-vs-ols-reg">2. Figure 2: rmcorr vs OLS reg<a class="anchor" aria-label="anchor" href="#figure-2-rmcorr-vs-ols-reg"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">.5</span>,<span class="fl">.5</span><span class="op">)</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>,<span class="fl">.75</span>,<span class="fl">0</span><span class="op">)</span>, </span>
<span>    oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">0</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">makeminiplot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">subxs</span>, <span class="va">sub.slope</span>, <span class="va">intercept</span>, <span class="va">constant</span><span class="op">=</span><span class="fl">0</span>, <span class="va">xax</span> <span class="op">=</span> <span class="st">"n"</span>, </span>
<span>                         <span class="va">yax</span> <span class="op">=</span> <span class="st">"n"</span>, <span class="va">legend</span> <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">mypal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">10</span>,<span class="st">'Paired'</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu">mypal</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># cols &lt;- c("#A6CEE3", "#9D686D", "#6A3D9A")</span></span>
<span>    </span>
<span>    <span class="va">subys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">subys</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">subxs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">*</span> <span class="va">sub.slope</span> <span class="op">+</span> <span class="va">intercept</span><span class="op">*</span><span class="va">i</span> <span class="op">+</span> <span class="va">constant</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">subxs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">subys</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"n"</span>, xlim <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span>, </span>
<span>         xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, xaxt <span class="op">=</span> <span class="va">xax</span>, yaxt <span class="op">=</span> <span class="va">yax</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">allx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">subxs</span><span class="op">)</span></span>
<span>    <span class="va">ally</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">subys</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ally</span><span class="op">~</span><span class="va">allx</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">subxs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,<span class="va">subys</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"o"</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">legend</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'bottomright'</span>, legend <span class="op">=</span> <span class="st">"OLS"</span>, lwd <span class="op">=</span> <span class="fl">1.25</span>, bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>                       cex <span class="op">=</span> <span class="fl">1</span>, inset <span class="op">=</span> <span class="op">-</span><span class="fl">0.03</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">subxs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">subxs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">.25</span><span class="op">)</span></span>
<span><span class="va">subxs</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">.25</span><span class="op">)</span></span>
<span><span class="va">subxs</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">.25</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#ols is positive</span></span>
<span><span class="fu">makeminiplot</span><span class="op">(</span><span class="va">subxs</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">4</span>, yax <span class="op">=</span> <span class="st">"s"</span>, legend <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu">makeminiplot</span><span class="op">(</span><span class="va">subxs</span>, <span class="fl">0</span>, <span class="fl">2.75</span><span class="op">)</span></span>
<span><span class="fu">makeminiplot</span><span class="op">(</span><span class="va">subxs</span>, <span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#ols is flat</span></span>
<span><span class="fu">makeminiplot</span><span class="op">(</span><span class="va">subxs</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="fl">2.45</span>, <span class="fl">3</span>, yax <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span></span>
<span><span class="fu">makeminiplot</span><span class="op">(</span><span class="va">subxs</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu">makeminiplot</span><span class="op">(</span><span class="va">subxs</span>, <span class="fl">1.5</span>, <span class="op">-</span><span class="fl">2.4</span>, <span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#ols is negative</span></span>
<span><span class="fu">makeminiplot</span><span class="op">(</span><span class="va">subxs</span>, <span class="op">-</span><span class="fl">.75</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">10</span>, yax <span class="op">=</span> <span class="st">"s"</span>, xax <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span></span>
<span><span class="fu">makeminiplot</span><span class="op">(</span><span class="va">subxs</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">3.1</span>, <span class="fl">10.9</span>, xax <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span></span>
<span><span class="fu">makeminiplot</span><span class="op">(</span><span class="va">subxs</span>, <span class="fl">.9</span>, <span class="op">-</span><span class="fl">4.6</span>, <span class="fl">12</span>, xax <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span>, outer <span class="op">=</span> <span class="cn">T</span>, line <span class="op">=</span> <span class="fl">1.5</span>, <span class="st">"x"</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.175</span>, <span class="fl">.5</span>, <span class="fl">.85</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">2</span>, outer <span class="op">=</span> <span class="cn">T</span>, line <span class="op">=</span> <span class="fl">1.5</span>, <span class="st">"y"</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.175</span>, <span class="fl">.5</span>, <span class="fl">.85</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="New_rmcorr_paper_analyses_figures_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># mtext(side = 3, outer = T, line = .5, </span></span>
<span><span class="co">#       c("a) rmcorr = -1", "b) rmcorr = 0", "c) rmcorr = 1"),</span></span>
<span><span class="co">#       at = c(.175, .5, .85), las = 1, cex = 1.5)</span></span>
<span></span>
<span><span class="co">#Figure 2. These notional plots illustrate the range of potential similarities and differences </span></span>
<span><span class="co">#in the intra-individual association assessed by rmcorr and the inter-individual association </span></span>
<span><span class="co">#assessed by ordinary least squares (OLS) regression. Rmcorr-values depend only on the </span></span>
<span><span class="co">#intra-individual association between variables and will be the same across different patterns </span></span>
<span><span class="co">#of inter-individual variability. (A) rrm = −1: depicts notional data with a perfect negative </span></span>
<span><span class="co">#intra-individual association between variables, (B) rrm = 0: depicts data with no </span></span>
<span><span class="co">#intra-individual association, and (C) rrm = 1: depicts data with a perfect positive </span></span>
<span><span class="co">#intra-individual association. In each column, the relationship between subjects </span></span>
<span><span class="co">#(inter-individual variability) is different, which does not change the rmcorr-values within a </span></span>
<span><span class="co">#column. However, this does change the association that would be predicted by OLS regression </span></span>
<span><span class="co">#(black lines) if the data were treated as IID or averaged by participant.</span></span>
<span></span>
<span><span class="co">#dev.copy2eps(file="plots/Figure2_Rmcorr_vs_OLS.eps", height = 8, width = 8)</span></span>
<span><span class="co">#dev.copy(pdf, file="plots/Figure2_Rmcorr_vs_OLS.pdf", height = 8, width = 8)</span></span>
<span><span class="co">#dev.off()</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="figure-3-rmcorr-wdata-transformations">3. Figure 3: rmcorr w/data transformations<a class="anchor" aria-label="anchor" href="#figure-3-rmcorr-wdata-transformations"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">initX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">newY</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">newX</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">rsq</span> <span class="op">&lt;-</span> <span class="fl">.7</span></span>
<span><span class="va">addy</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">addx</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">addy</span> <span class="op">&lt;-</span> <span class="va">addy</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>    <span class="va">addx</span> <span class="op">&lt;-</span> <span class="va">addx</span> <span class="op">+</span> <span class="fl">.25</span></span>
<span>    </span>
<span>    <span class="va">tempData</span> <span class="op">&lt;-</span> <span class="va">initX</span><span class="op">[</span><span class="va">sub</span> <span class="op">==</span> <span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">addx</span></span>
<span>    <span class="va">sdx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">tempData</span><span class="op">)</span></span>
<span>    <span class="va">sdnoise</span> <span class="op">&lt;-</span> <span class="va">sdx</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">rsq</span><span class="op">)</span><span class="op">/</span><span class="va">rsq</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">tempy</span> <span class="op">&lt;-</span> <span class="va">tempData</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">0</span>,<span class="va">sdnoise</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">addy</span>,<span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">newY</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">newY</span>, <span class="va">tempy</span><span class="op">)</span></span>
<span>    <span class="va">newX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">newX</span>,<span class="va">tempData</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.75</span>, <span class="fl">.75</span>, <span class="fl">0</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">###original plot</span></span>
<span><span class="va">exampleMat</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">sub</span>,<span class="va">newX</span>,<span class="va">newY</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">example1.rmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmcorr.html">rmcorr</a></span><span class="op">(</span><span class="va">sub</span>,<span class="va">newX</span>,<span class="va">newY</span>,<span class="va">exampleMat</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in rmcorr(sub, newX, newY, exampleMat): 'sub' coerced into a factor</span></span>
<span></span>
<span><span class="va">mypal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">10</span>,<span class="st">'Paired'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">example1.rmc</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">""</span>, </span>
<span>     overall <span class="op">=</span> <span class="cn">F</span>, palette <span class="op">=</span> <span class="va">mypal</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.5</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5</span>,<span class="fl">2</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">example1.rmc.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">example1.rmc</span><span class="op">$</span><span class="va">r</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">example1.rmc.p</span> <span class="op">&lt;-</span> <span class="fu">pvals.fct</span><span class="op">(</span><span class="va">example1.rmc</span><span class="op">$</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.5</span>, <span class="fl">2</span>, adj <span class="op">=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">r</span><span class="op">[</span><span class="va">rm</span><span class="op">]</span><span class="op">)</span><span class="op">~</span><span class="st">"="</span><span class="op">~</span> <span class="fu">.</span><span class="op">(</span><span class="va">example1.rmc.r</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.5</span>, <span class="fl">1.75</span>, adj <span class="op">=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'p'</span><span class="op">)</span><span class="op">~</span><span class="fu">.</span><span class="op">(</span><span class="va">example1.rmc.p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">2</span>, <span class="st">"y"</span>, las <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">2.5</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">###add 1 to all x's, multiply by 2</span></span>
<span><span class="va">exampleMat2</span> <span class="op">&lt;-</span> <span class="va">exampleMat</span></span>
<span><span class="va">exampleMat2</span><span class="op">$</span><span class="va">newX</span> <span class="op">&lt;-</span> <span class="va">exampleMat2</span><span class="op">$</span><span class="va">newX</span> <span class="op">*</span> <span class="fl">.5</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="va">example2.rmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmcorr.html">rmcorr</a></span><span class="op">(</span><span class="va">sub</span>, <span class="va">newX</span>, <span class="va">newY</span>, <span class="va">exampleMat2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in rmcorr(sub, newX, newY, exampleMat2): 'sub' coerced into a factor</span></span>
<span></span>
<span><span class="va">example2.rmc.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">example2.rmc</span><span class="op">$</span><span class="va">r</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">example2.rmc.p</span> <span class="op">&lt;-</span> <span class="fu">pvals.fct</span><span class="op">(</span><span class="va">example2.rmc</span><span class="op">$</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">example2.rmc</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">""</span>, overall <span class="op">=</span> <span class="cn">F</span>,</span>
<span>     palette <span class="op">=</span> <span class="va">mypal</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.5</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5</span>,<span class="fl">2</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.5</span>, <span class="fl">2</span>, adj <span class="op">=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">r</span><span class="op">[</span><span class="va">rm</span><span class="op">]</span><span class="op">)</span><span class="op">~</span><span class="st">"="</span><span class="op">~</span> <span class="fu">.</span><span class="op">(</span><span class="va">example2.rmc.r</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.5</span>, <span class="fl">1.75</span>, adj <span class="op">=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'p'</span><span class="op">)</span><span class="op">~</span><span class="fu">.</span><span class="op">(</span><span class="va">example2.rmc.p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">2</span>, <span class="st">"y"</span>, las <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">2.5</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">###just add -2 to sub3's ys</span></span>
<span><span class="va">exampleMat3</span> <span class="op">&lt;-</span> <span class="va">exampleMat</span></span>
<span><span class="va">exampleMat3</span><span class="op">$</span><span class="va">newY</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">exampleMat3</span><span class="op">$</span><span class="va">newY</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">-</span> <span class="fl">2</span></span>
<span><span class="va">example3.rmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmcorr.html">rmcorr</a></span><span class="op">(</span><span class="va">sub</span>, <span class="va">newX</span>, <span class="va">newY</span>, <span class="va">exampleMat3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in rmcorr(sub, newX, newY, exampleMat3): 'sub' coerced into a factor</span></span>
<span></span>
<span><span class="va">example3.rmc.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">example3.rmc</span><span class="op">$</span><span class="va">r</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">example3.rmc.p</span> <span class="op">&lt;-</span> <span class="fu">pvals.fct</span><span class="op">(</span><span class="va">example3.rmc</span><span class="op">$</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">example3.rmc</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">""</span>, overall <span class="op">=</span> <span class="cn">F</span>,</span>
<span>     palette <span class="op">=</span> <span class="va">mypal</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.5</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5</span>,<span class="fl">2</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.5</span>, <span class="fl">2</span>, adj <span class="op">=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">r</span><span class="op">[</span><span class="va">rm</span><span class="op">]</span><span class="op">)</span><span class="op">~</span><span class="st">"="</span><span class="op">~</span> <span class="fu">.</span><span class="op">(</span><span class="va">example3.rmc.r</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.5</span>, <span class="fl">1.75</span>, adj <span class="op">=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'p'</span><span class="op">)</span><span class="op">~</span><span class="fu">.</span><span class="op">(</span><span class="va">example3.rmc.p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">2</span>, <span class="st">"y"</span>, las <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">2.5</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></code></pre></div>
<p><img src="New_rmcorr_paper_analyses_figures_files/figure-html/unnamed-chunk-4-1.png" width="1152"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Figure 3. Rmcorr-values (and corresponding p-values) do not change with linear </span></span>
<span><span class="co">#transformations of the data, illustrated here with three examples: (A) original, (B) x/2 + 1, and (C) y − 1.</span></span>
<span></span>
<span><span class="co">#dev.copy2eps(file="plots/Figure3_Transformations.eps", height = 6, width = 12)</span></span>
<span><span class="co">#dev.copy(pdf, file="plots/Figure3_Transformations.pdf", height = 6, width = 12)</span></span>
<span><span class="co">#dev.off()</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="power">4. Figure 4: Power curves<a class="anchor" aria-label="anchor" href="#power"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">power.rmcorr</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">k</span>, <span class="va">N</span>, <span class="va">effectsizer</span>, <span class="va">sig</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.r.test.html" class="external-link">pwr.r.test</a></span><span class="op">(</span>n <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>, r <span class="op">=</span> <span class="va">effectsizer</span>, sig.level <span class="op">=</span> <span class="va">sig</span><span class="op">)</span> </span>
<span>    <span class="co">#df are specified this way because pwr.r.test assumes the input is N, so it uses N - 2 for the df</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, cex.lab<span class="op">=</span><span class="fl">1.50</span>, cex.axis<span class="op">=</span><span class="fl">1.40</span>, cex.sub<span class="op">=</span><span class="fl">1.40</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.5</span>,<span class="fl">4.5</span>,<span class="fl">1.75</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Small effect size</span></span>
<span><span class="va">k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span> </span>
<span><span class="va">nvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">powPearsonSmall</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">nvals</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.r.test.html" class="external-link">pwr.r.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">x</span>, r<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span><span class="op">$</span><span class="va">power</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bluecolors</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#c6dbef"</span>, <span class="st">"#9ecae1"</span>, <span class="st">"#6baed6"</span>, <span class="st">"#4292c6"</span>, <span class="st">"#2171b5"</span>, <span class="st">"#084594"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nvals</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, length.out<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nvals</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Sample</span><span class="op">~</span><span class="va">Size</span><span class="op">~</span><span class="st">"("</span><span class="op">*</span><span class="fu">italic</span><span class="op">(</span><span class="st">'N'</span><span class="op">)</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span>,</span>
<span>     yaxt <span class="op">=</span> <span class="st">"n"</span>, ylab <span class="op">=</span> <span class="st">"Power"</span>, las <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">300</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">300</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">yLabels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at<span class="op">=</span><span class="va">yLabels</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="va">yLabels</span><span class="op">)</span>, fmt<span class="op">=</span><span class="st">"%2.0f%%"</span><span class="op">)</span>, las<span class="op">=</span><span class="fl">1</span>, cex.sub <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> </span>
<span><span class="op">{</span></span>
<span>    <span class="va">powvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">nvals</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">power.rmcorr</span><span class="op">(</span><span class="va">k</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">x</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">$</span><span class="va">power</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">nvals</span>, <span class="va">powvals</span>, lwd<span class="op">=</span><span class="fl">2.5</span>, col<span class="op">=</span><span class="va">bluecolors</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, lwd<span class="op">=</span><span class="fl">2.5</span>, col<span class="op">=</span><span class="va">bluecolors</span>, bty<span class="op">=</span> <span class="st">'n'</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"3"</span>, <span class="st">"5"</span>, <span class="st">"10"</span>, <span class="st">"20"</span><span class="op">)</span>, title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'k'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">nvals</span>, <span class="va">powPearsonSmall</span>, col<span class="op">=</span><span class="va">bluecolors</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lwd<span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0.8</span>, b<span class="op">=</span><span class="fl">0</span>, col<span class="op">=</span><span class="fl">1</span>, lty<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Medium effect size</span></span>
<span><span class="va">k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">nvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">60</span><span class="op">)</span></span>
<span><span class="va">powPearsonMedium</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">nvals</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.r.test.html" class="external-link">pwr.r.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">x</span>, r<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">$</span><span class="va">power</span><span class="op">)</span></span>
<span><span class="va">greencolors</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#c7e9c0"</span>,<span class="st">"#a1d99b"</span>,<span class="st">"#74c476"</span>,<span class="st">"#41ab5d"</span>,<span class="st">"#238b45"</span>,<span class="st">"#005a32"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#orangecols&lt;-brewer.pal(9, "Oranges")</span></span>
<span><span class="co">#orangecols3&lt;-c(orangecols[2],orangecols[3],orangecols[5],orangecols[7],orangecols[9])</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nvals</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, length.out<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nvals</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Sample</span><span class="op">~</span><span class="va">Size</span><span class="op">~</span><span class="st">"("</span><span class="op">*</span><span class="fu">italic</span><span class="op">(</span><span class="st">'N'</span><span class="op">)</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span>,</span>
<span>     yaxt <span class="op">=</span> <span class="st">"n"</span>, ylab <span class="op">=</span> <span class="st">"Power"</span>, las <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">60</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">yLabels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at<span class="op">=</span><span class="va">yLabels</span>, main <span class="op">=</span> <span class="st">"Power"</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="va">yLabels</span><span class="op">)</span>, fmt<span class="op">=</span><span class="st">"%2.0f%%"</span><span class="op">)</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> </span>
<span><span class="op">{</span></span>
<span>    <span class="va">powvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">nvals</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">power.rmcorr</span><span class="op">(</span><span class="va">k</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">x</span>, <span class="fl">0.3</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">$</span><span class="va">power</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">nvals</span>, <span class="va">powvals</span>, lwd<span class="op">=</span><span class="fl">2.5</span>, col<span class="op">=</span><span class="va">greencolors</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, lwd<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="va">greencolors</span>, bty <span class="op">=</span> <span class="st">'n'</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"3"</span>, <span class="st">"5"</span>, <span class="st">"10"</span>, <span class="st">"20"</span><span class="op">)</span>, title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'k'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">nvals</span>, <span class="va">powPearsonMedium</span>, col<span class="op">=</span><span class="va">greencolors</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0.8</span>, b<span class="op">=</span><span class="fl">0</span>, col<span class="op">=</span><span class="fl">1</span>, lty<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Large effect size</span></span>
<span><span class="va">k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">nvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">powPearsonlarge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">nvals</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.r.test.html" class="external-link">pwr.r.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">x</span>, r<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">$</span><span class="va">power</span><span class="op">)</span></span>
<span></span>
<span><span class="va">purplecolors</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#f2f0f7"</span>, <span class="st">"#dadaeb"</span>, <span class="st">"#bcbddc"</span>, <span class="st">"#9e9ac8"</span>, <span class="st">"#807dba"</span>, <span class="st">"#6a51a3"</span>, <span class="st">"#4a1486"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nvals</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, length.out<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nvals</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Sample</span><span class="op">~</span><span class="va">Size</span><span class="op">~</span><span class="st">"("</span><span class="op">*</span><span class="fu">italic</span><span class="op">(</span><span class="st">'N'</span><span class="op">)</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span>,</span>
<span>     yaxt <span class="op">=</span> <span class="st">"n"</span>, ylab <span class="op">=</span> <span class="st">"Power"</span>, las <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"white"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">40</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">yLabels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at<span class="op">=</span><span class="va">yLabels</span>, main <span class="op">=</span> <span class="st">"Power"</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="va">yLabels</span><span class="op">)</span>, fmt<span class="op">=</span><span class="st">"%2.0f%%"</span><span class="op">)</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> </span>
<span><span class="op">{</span></span>
<span>    <span class="va">powvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">nvals</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">power.rmcorr</span><span class="op">(</span><span class="va">k</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">x</span>, <span class="fl">0.5</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">$</span><span class="va">power</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">nvals</span>, <span class="va">powvals</span>, lwd<span class="op">=</span><span class="fl">2.5</span>, col<span class="op">=</span><span class="va">purplecolors</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, lwd<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="va">purplecolors</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"3"</span>, <span class="st">"5"</span>, <span class="st">"10"</span>, <span class="st">"20"</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">'n'</span>, title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'k'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0.8</span>, b<span class="op">=</span><span class="fl">0</span>, col<span class="op">=</span><span class="fl">1</span>, lty<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">nvals</span>, <span class="va">powPearsonlarge</span>, col<span class="op">=</span><span class="va">purplecolors</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="New_rmcorr_paper_analyses_figures_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Figure 4. Power curves for (A) small, rrm, and r = 0.10, (B) medium, rrm, and r = 0.3, and (C) large effect sizes, rrm, </span></span>
<span><span class="co">#and r = 0.50. X-axis is sample size. Note the sample size range differs among the panels. Y-axis is power. k denotes </span></span>
<span><span class="co">#the number of repeated paired measures. Eighty percent power is indicated by the dotted black line. For rmcorr, the power of </span></span>
<span><span class="co">#k = 2 is asymptotically equivalent to k = 1. A comparison to the power for a Pearson correlation with one data point per </span></span>
<span><span class="co">#participant (k = 1) is also shown.</span></span>
<span></span>
<span><span class="co">#dev.copy2eps(file="plots/Figure4_Power_curves.eps", height = 6, width = 6)</span></span>
<span><span class="co">#dev.copy(pdf, file="plots/Figure4_Power_curve.pdf", height = 6, width = 6)</span></span>
<span><span class="co">#dev.off()</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="brain-volume-and-age-rmcorr-and-simple-regcor-results-and-figure-5">5. Brain volume and age rmcorr and simple reg/cor results and Figure
5<a class="anchor" aria-label="anchor" href="#brain-volume-and-age-rmcorr-and-simple-regcor-results-and-figure-5"></a>
</h3>
<div class="section level4">
<h4 id="rmcorr-and-simple-reg-results">rmcorr and simple reg results<a class="anchor" aria-label="anchor" href="#rmcorr-and-simple-reg-results"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Note for details on Raz: Data captured from Figure 8, Cerebellar Hemispheres (lower right)</span></span>
<span><span class="co">#a) Reproduce correlations in the paper: Cross-sectional (correlation at Time 1)</span></span>
<span><span class="va">Time1raz2005</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">raz2005</span>, <span class="va">Time</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Time2raz2005</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">raz2005</span>, <span class="va">Time</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">a1.rtest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">Time1raz2005</span><span class="op">$</span><span class="va">Age</span>, <span class="va">Time1raz2005</span><span class="op">$</span><span class="va">Volume</span><span class="op">)</span> </span>
<span><span class="va">a2.rtest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">Time2raz2005</span><span class="op">$</span><span class="va">Age</span>, <span class="va">Time2raz2005</span><span class="op">$</span><span class="va">Volume</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a1.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Time1raz2005</span><span class="op">$</span><span class="va">Volume</span> <span class="op">~</span> <span class="va">Time1raz2005</span><span class="op">$</span><span class="va">Age</span><span class="op">)</span></span>
<span><span class="va">a2.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Time2raz2005</span><span class="op">$</span><span class="va">Volume</span> <span class="op">~</span> <span class="va">Time2raz2005</span><span class="op">$</span><span class="va">Age</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary.a1.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">a1.lm</span><span class="op">)</span></span>
<span><span class="va">summary.a2.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">a2.lm</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a1.lm.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">a1.rtest</span><span class="op">$</span><span class="va">estimate</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#Same as Pearson correlation for simple regression</span></span>
<span><span class="va">a1.lm.p</span> <span class="op">&lt;-</span> <span class="fu">pvals.fct</span><span class="op">(</span><span class="va">summary.a1.lm</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a2.lm.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">a2.rtest</span><span class="op">$</span><span class="va">estimate</span> ,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#Same as Pearson correlation for simple regression</span></span>
<span><span class="va">a2.lm.p</span> <span class="op">&lt;-</span> <span class="fu">pvals.fct</span><span class="op">(</span><span class="va">summary.a2.lm</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#b) rmcorr analysis</span></span>
<span><span class="va">brainvolage.rmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmcorr.html">rmcorr</a></span><span class="op">(</span>participant <span class="op">=</span> <span class="va">Participant</span>, measure1 <span class="op">=</span> <span class="va">Age</span>, measure2 <span class="op">=</span> <span class="va">Volume</span>, dataset <span class="op">=</span> <span class="va">raz2005</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in rmcorr(participant = Participant, measure1 = Age, measure2 =</span></span>
<span><span class="co">#&gt; Volume, : 'Participant' coerced into a factor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">brainvolage.rmc</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Repeated measures correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; r</span></span>
<span><span class="co">#&gt; -0.7044077</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; degrees of freedom</span></span>
<span><span class="co">#&gt; 71</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; p-value</span></span>
<span><span class="co">#&gt; 3.561007e-12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 95% confidence interval</span></span>
<span><span class="co">#&gt; -0.8053581 -0.5637514</span></span>
<span></span>
<span><span class="va">rmcorr.5b.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">brainvolage.rmc</span><span class="op">$</span><span class="va">r</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rmcorr.5b.p</span> <span class="op">&lt;-</span> <span class="fu">pvals.fct</span><span class="op">(</span><span class="va">brainvolage.rmc</span><span class="op">$</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#c) simple regression on averaged data</span></span>
<span></span>
<span><span class="va">avgRaz2005</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">raz2005</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">raz2005</span><span class="op">$</span><span class="va">Participant</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">avg.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Volume</span><span class="op">~</span><span class="va">Age</span>, data <span class="op">=</span> <span class="va">avgRaz2005</span><span class="op">)</span></span>
<span><span class="va">summary.av.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">avg.lm</span><span class="op">)</span></span>
<span><span class="va">c.rtest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">avgRaz2005</span><span class="op">$</span><span class="va">Age</span>, <span class="va">avgRaz2005</span><span class="op">$</span><span class="va">Volume</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">c.rtest</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pearson's product-moment correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  avgRaz2005$Age and avgRaz2005$Volume</span></span>
<span><span class="co">#&gt; t = -3.4912, df = 70, p-value = 0.000837</span></span>
<span><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -0.5662456 -0.1684542</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;        cor </span></span>
<span><span class="co">#&gt; -0.3850943</span></span>
<span></span>
<span><span class="va">fig.5c.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">c.rtest</span><span class="op">$</span><span class="va">estimate</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fig.5c.p</span> <span class="op">&lt;-</span>  <span class="fu">pvals.fct</span><span class="op">(</span><span class="va">summary.av.lm</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Not graphed in Figure 5</span></span>
<span><span class="co">#d) simple regression on aggregated data (incorrect overfit model):</span></span>
<span><span class="co">#Although in this case it doesn't matter </span></span>
<span></span>
<span><span class="va">brainvolage.lm</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Volume</span><span class="op">~</span><span class="va">Age</span>, data <span class="op">=</span> <span class="va">raz2005</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">brainvolage.lm</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Volume ~ Age, data = raz2005)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)          Age  </span></span>
<span><span class="co">#&gt;    151.9068      -0.3399</span></span>
<span></span>
<span><span class="va">d.rtest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">raz2005</span><span class="op">$</span><span class="va">Age</span>, <span class="va">raz2005</span><span class="op">$</span><span class="va">Volume</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">d.rtest</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pearson's product-moment correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  raz2005$Age and raz2005$Volume</span></span>
<span><span class="co">#&gt; t = -5.165, df = 142, p-value = 7.984e-07</span></span>
<span><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -0.5269809 -0.2503991</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;        cor </span></span>
<span><span class="co">#&gt; -0.3976861</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#a</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span>, oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span>, cex.axis <span class="op">=</span> <span class="fl">1.10</span>, cex.sub <span class="op">=</span> <span class="fl">1.10</span>, cex.lab <span class="op">=</span> <span class="fl">1.15</span><span class="op">)</span></span>
<span><span class="co">#cex.lab=1.1, cex.axis=1.1, cex.main=1.2, cex.sub=1.2)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Volume</span> <span class="op">~</span> <span class="va">Age</span>, data <span class="op">=</span> <span class="va">Time1raz2005</span>, pch <span class="op">=</span> <span class="fl">16</span>,  xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">85</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">105</span>,<span class="fl">170</span><span class="op">)</span>, xaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">a1.lm</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">axis.break</span><span class="op">(</span>axis <span class="op">=</span> <span class="fl">2</span>, style <span class="op">=</span> <span class="st">"slash"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">75</span>, <span class="fl">170</span>, <span class="st">"Time 1"</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">18</span>,<span class="fl">111</span>, adj <span class="op">=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'r'</span><span class="op">)</span><span class="op">~</span><span class="st">"="</span><span class="op">~</span> <span class="fu">.</span><span class="op">(</span><span class="va">a1.lm.r</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">18</span>,<span class="fl">107</span>, adj <span class="op">=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'p'</span><span class="op">)</span><span class="op">~</span><span class="fu">.</span><span class="op">(</span><span class="va">a1.lm.p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"A)"</span>, adj <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.5</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Volume</span> <span class="op">~</span> <span class="va">Age</span>, data <span class="op">=</span> <span class="va">Time2raz2005</span>, pch <span class="op">=</span> <span class="fl">16</span>, ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">85</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">105</span>,<span class="fl">170</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">a2.lm</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">axis.break</span><span class="op">(</span>axis <span class="op">=</span> <span class="fl">2</span>, style <span class="op">=</span> <span class="st">"slash"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">75</span>, <span class="fl">170</span>, <span class="st">"Time 2"</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">18</span>,<span class="fl">111</span>, adj <span class="op">=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'r'</span><span class="op">)</span><span class="op">~</span><span class="st">"="</span><span class="op">~</span> <span class="fu">.</span><span class="op">(</span><span class="va">a2.lm.r</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">18</span>,<span class="fl">107</span>, adj <span class="op">=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'p'</span><span class="op">)</span><span class="op">~</span><span class="fu">.</span><span class="op">(</span><span class="va">a2.lm.p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Cerebellar</span><span class="op">~</span><span class="va">Hemisphere</span><span class="op">~</span><span class="va">Volume</span><span class="op">~</span><span class="op">(</span><span class="va">cm</span><span class="op">^</span><span class="op">{</span><span class="fl">3</span><span class="op">}</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">.9</span>,</span>
<span>      outer <span class="op">=</span> <span class="cn">T</span>, line <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, las <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#b</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.5</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#blueset &lt;- brewer.pal(8, 'Blues')</span></span>
<span><span class="co">#pal &lt;- colorRampPalette(blueset)</span></span>
<span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu">kelly</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">22</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">brainvolage.rmc</span>, overall <span class="op">=</span> <span class="cn">F</span>, palette <span class="op">=</span> <span class="va">pal</span>, ylab <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"Age"</span>, </span>
<span>     cex <span class="op">=</span> <span class="fl">1.2</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">85</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">105</span>,<span class="fl">170</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu">axis.break</span><span class="op">(</span>axis <span class="op">=</span> <span class="fl">2</span>, style <span class="op">=</span> <span class="st">"slash"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">107</span>, adj <span class="op">=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">r</span><span class="op">[</span><span class="va">rm</span><span class="op">]</span><span class="op">)</span><span class="op">~</span><span class="st">"="</span><span class="op">~</span> <span class="fu">.</span><span class="op">(</span><span class="va">rmcorr.5b.r</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">105</span>, adj <span class="op">=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'p'</span><span class="op">)</span><span class="op">~</span><span class="fu">.</span><span class="op">(</span><span class="va">rmcorr.5b.p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"B)"</span>, adj <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#c</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Volume</span><span class="op">~</span><span class="va">Age</span>, data <span class="op">=</span> <span class="va">avgRaz2005</span>, ylab <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"Age"</span>, cex <span class="op">=</span> <span class="fl">1.2</span>, pch <span class="op">=</span> <span class="fl">16</span>, </span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">85</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">105</span>,<span class="fl">170</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">brainvolage.lm</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">axis.break</span><span class="op">(</span>axis <span class="op">=</span> <span class="fl">2</span>, style <span class="op">=</span> <span class="st">"slash"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">107</span>, adj <span class="op">=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'r'</span><span class="op">)</span><span class="op">~</span><span class="st">"="</span><span class="op">~</span> <span class="fu">.</span><span class="op">(</span><span class="va">fig.5c.r</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#incorrect positive sign in the paper</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">105</span>, adj <span class="op">=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'p'</span><span class="op">)</span><span class="op">~</span><span class="fu">.</span><span class="op">(</span><span class="va">fig.5c.p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#text(20,107,paste('r =', round(c.rtest$est,2),'\np &lt; 0.001'), adj = 0)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"C)"</span>, adj <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="New_rmcorr_paper_analyses_figures_files/figure-html/unnamed-chunk-6-1.png" width="864"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Figure 5. Comparison of rmcorr and simple regression/correlation results for age and brain structure volume data. </span></span>
<span><span class="co">#Each dot represents one of two separate observations of age and CBH for a participant. (A) #Separate simple </span></span>
<span><span class="co">#regressions/correlations by time: each observation is treated as independent, represented by shading all the data </span></span>
<span><span class="co">#points black. The red line is the fit of the simple regression/correlation. (B) Rmcorr: observations from the same </span></span>
<span><span class="co">#participant are given the same color, with corresponding lines to show the rmcorr fit for each participant. (C) </span></span>
<span><span class="co">#Simple regression/correlation: averaged by participant. Note that the effect size is greater (stronger negative </span></span>
<span><span class="co">#relationship) using rmcorr (B) than with either use of simple regression models (A) and (C). This figure was </span></span>
<span><span class="co">#created using data from Raz et al. (2005).</span></span>
<span><span class="co">#dev.copy2eps(file="plots/Figure5_Volume_Age.eps", width = 9, height = 6)</span></span>
<span><span class="co">#dev.copy(pdf, file="plots/Figure5_Volume_Age.pdf", height = 6, width = 6)</span></span>
<span><span class="co">#dev.off()</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="visual-search-rmcorr-and-simple-regcor-results-and-figure-6">6. Visual search rmcorr and simple reg/cor results and Figure 6<a class="anchor" aria-label="anchor" href="#visual-search-rmcorr-and-simple-regcor-results-and-figure-6"></a>
</h3>
<div class="section level4">
<h4 id="rmcorr-and-simple-reg-results-1">rmcorr and simple reg results<a class="anchor" aria-label="anchor" href="#rmcorr-and-simple-reg-results-1"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#a - rmcorr</span></span>
<span><span class="va">vissearch.rmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmcorr.html">rmcorr</a></span><span class="op">(</span>participant <span class="op">=</span> <span class="va">sub</span>, measure1 <span class="op">=</span> <span class="va">rt</span>, measure2 <span class="op">=</span> <span class="va">acc</span>, dataset <span class="op">=</span> <span class="va">gilden2010</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in rmcorr(participant = sub, measure1 = rt, measure2 = acc, dataset =</span></span>
<span><span class="co">#&gt; gilden2010): 'sub' coerced into a factor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">vissearch.rmc</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Repeated measures correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; r</span></span>
<span><span class="co">#&gt; -0.406097</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; degrees of freedom</span></span>
<span><span class="co">#&gt; 32</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; p-value</span></span>
<span><span class="co">#&gt; 0.01716871</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 95% confidence interval</span></span>
<span><span class="co">#&gt; -0.6611673 -0.06687244</span></span>
<span></span>
<span><span class="co">#b - averaged data</span></span>
<span><span class="va">gildenMeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">gilden2010</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">gilden2010</span><span class="op">$</span><span class="va">sub</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">avg.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">acc</span> <span class="op">~</span> <span class="va">rt</span>, data <span class="op">=</span> <span class="va">gildenMeans</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">avg.lm</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = acc ~ rt, data = gildenMeans)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)           rt  </span></span>
<span><span class="co">#&gt;      0.8132       0.1777</span></span>
<span><span class="va">b.rtest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">gildenMeans</span><span class="op">$</span><span class="va">rt</span>, <span class="va">gildenMeans</span><span class="op">$</span><span class="va">acc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">b.rtest</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pearson's product-moment correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  gildenMeans$rt and gildenMeans$acc</span></span>
<span><span class="co">#&gt; t = 2.1966, df = 9, p-value = 0.05565</span></span>
<span><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -0.01409542  0.87910346</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;       cor </span></span>
<span><span class="co">#&gt; 0.5907749</span></span>
<span></span>
<span><span class="co">#c - aggregated data (overfit, incorrectly treated as independent participants/observations)</span></span>
<span><span class="va">agg.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">acc</span> <span class="op">~</span> <span class="va">rt</span>, data <span class="op">=</span> <span class="va">gilden2010</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">agg.lm</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = acc ~ rt, data = gilden2010)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)           rt  </span></span>
<span><span class="co">#&gt;      0.8612       0.1111</span></span>
<span><span class="va">c.rtest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">gilden2010</span><span class="op">$</span><span class="va">rt</span>, <span class="va">gilden2010</span><span class="op">$</span><span class="va">acc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">c.rtest</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pearson's product-moment correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  gilden2010$rt and gilden2010$acc</span></span>
<span><span class="co">#&gt; t = 2.6401, df = 42, p-value = 0.01158</span></span>
<span><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.09053513 0.60625185</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;       cor </span></span>
<span><span class="co">#&gt; 0.3772751</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4.6</span>,<span class="fl">4</span>,<span class="fl">0.5</span><span class="op">)</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.2</span>,<span class="fl">0.8</span>,<span class="fl">0</span><span class="op">)</span>,  oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span>, cex.axis <span class="op">=</span> <span class="fl">1.2</span>, cex.sub <span class="op">=</span> <span class="fl">1.1</span>, cex.lab <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> </span>
<span><span class="co">#, cex.axis = 1.10, cex.sub = 1.10, cex.lab = 1.15)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vissearch.rmc</span>, overall <span class="op">=</span> <span class="cn">F</span>, xlab <span class="op">=</span> <span class="st">"Response Time (seconds)"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"Accuracy"</span>, cex <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.79</span>, <span class="fl">1</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>, <span class="fl">.95</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu">axis.break</span><span class="op">(</span>axis <span class="op">=</span> <span class="fl">1</span>, style <span class="op">=</span> <span class="st">"slash"</span><span class="op">)</span></span>
<span><span class="fu">axis.break</span><span class="op">(</span>axis <span class="op">=</span> <span class="fl">2</span>, style <span class="op">=</span> <span class="st">"slash"</span><span class="op">)</span>               <span class="co">#example of rounding and pvals.fct inside text()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.8</span>, adj <span class="op">=</span> <span class="fl">1</span>,    <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">r</span><span class="op">[</span><span class="va">rm</span><span class="op">]</span><span class="op">)</span><span class="op">~</span><span class="st">"="</span><span class="op">~</span><span class="fu">.</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vissearch.rmc</span><span class="op">$</span><span class="va">r</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.7925</span>, adj <span class="op">=</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'p'</span><span class="op">)</span><span class="op">~</span><span class="st">"&lt;"</span><span class="op">~</span><span class="fu">.</span><span class="op">(</span><span class="fu">pvals.fct</span><span class="op">(</span><span class="va">vissearch.rmc</span><span class="op">$</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"A)"</span>, adj <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">acc</span><span class="op">~</span><span class="va">rt</span>, data <span class="op">=</span> <span class="va">gildenMeans</span>, cex <span class="op">=</span> <span class="fl">1.2</span>, pch <span class="op">=</span> <span class="fl">16</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.79</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>, <span class="fl">.95</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Response Time (seconds)"</span>,  ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">avg.lm</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">axis.break</span><span class="op">(</span>axis <span class="op">=</span> <span class="fl">1</span>, style <span class="op">=</span> <span class="st">"slash"</span><span class="op">)</span></span>
<span><span class="fu">axis.break</span><span class="op">(</span>axis <span class="op">=</span> <span class="fl">2</span>, style <span class="op">=</span> <span class="st">"slash"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.8</span>,    adj <span class="op">=</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'r'</span><span class="op">)</span><span class="op">~</span><span class="st">"="</span><span class="op">~</span> <span class="fu">.</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">b.rtest</span><span class="op">$</span><span class="va">estimate</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.7925</span>, adj <span class="op">=</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'p'</span><span class="op">)</span><span class="op">~</span><span class="st">"="</span><span class="op">~</span><span class="fu">.</span><span class="op">(</span><span class="fu">pvals.fct</span><span class="op">(</span><span class="va">b.rtest</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="co">#text(.95,.8,paste('r =', round(b.rtest$est,2),'\np =', round(b.rtest$p.value,2)), adj = 1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"B)"</span>, adj <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">acc</span><span class="op">~</span><span class="va">rt</span>, data <span class="op">=</span> <span class="va">gilden2010</span>, xlab <span class="op">=</span> <span class="st">"Response Time (seconds)"</span>, ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>     cex <span class="op">=</span> <span class="fl">1.2</span>, pch <span class="op">=</span> <span class="fl">16</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.79</span>, <span class="fl">1</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>, <span class="fl">.95</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">agg.lm</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">axis.break</span><span class="op">(</span>axis <span class="op">=</span> <span class="fl">1</span>, style <span class="op">=</span> <span class="st">"slash"</span><span class="op">)</span></span>
<span><span class="fu">axis.break</span><span class="op">(</span>axis <span class="op">=</span> <span class="fl">2</span>, style <span class="op">=</span> <span class="st">"slash"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.8</span>, adj <span class="op">=</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'r'</span><span class="op">)</span><span class="op">~</span><span class="st">"="</span><span class="op">~</span> <span class="fu">.</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">c.rtest</span><span class="op">$</span><span class="va">estimate</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.7925</span>, adj <span class="op">=</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="st">'p'</span><span class="op">)</span><span class="op">~</span><span class="st">"&lt;"</span><span class="op">~</span><span class="fu">.</span><span class="op">(</span><span class="fu">pvals.fct</span><span class="op">(</span><span class="va">c.rtest</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"C)"</span>, adj <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="New_rmcorr_paper_analyses_figures_files/figure-html/unnamed-chunk-7-1.png" width="864"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#text(.95,.8,paste('r =', round(c.rtest$est,2),'\np =', round(c.rtest$p.value,2)), adj = 1)</span></span>
<span></span>
<span><span class="co">#Figure 6. The x-axis is reaction time (seconds) and the y-axis is accuracy in visual search. (A) Rmcorr: each dot represents </span></span>
<span><span class="co">#the average reaction time and accuracy for a block, color identifies participant, #and colored lines show rmcorr fits for </span></span>
<span><span class="co">#each participant. (B) Simple regression/correlation (averaged data): each dot represents a block, (improperly) treated as an </span></span>
<span><span class="co">#independent observation. The red line is #the fit to the simple regression/correlation. (C) Simple regression/correlation </span></span>
<span><span class="co">#(aggregated data): improperly treating each dot as independent. This figure was created using data from Gilden et al. (2010).</span></span>
<span><span class="co">#dev.copy2eps(file="plots/Figure6_Visual_Search.eps", width = 9, height = 6)</span></span>
<span><span class="co">#dev.copy(pdf, file="plots/Figure6_Visual_Search.pdf", height = 9, width = 6)</span></span>
<span><span class="co">#dev.off()</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="appendix-c">Appendix C<a class="anchor" aria-label="anchor" href="#appendix-c"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Rmcorr and multilevel model with Raz et al. 2005 data</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brainvolage.rmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmcorr.html">rmcorr</a></span><span class="op">(</span>participant <span class="op">=</span> <span class="va">Participant</span>, measure1 <span class="op">=</span> <span class="va">Age</span>, measure2 <span class="op">=</span> <span class="va">Volume</span>, dataset <span class="op">=</span> <span class="va">raz2005</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Null multilevel model: Random intercept and fixed slope</span></span>
<span><span class="va">null.vol</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">Volume</span> <span class="op">~</span> <span class="va">Age</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Participant</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">raz2005</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Model fit</span></span>
<span><span class="va">null.vol</span></span>
<span><span class="co">#&gt; Linear mixed model fit by maximum likelihood  ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: Volume ~ Age + (1 | Participant)</span></span>
<span><span class="co">#&gt;    Data: raz2005</span></span>
<span><span class="co">#&gt;       AIC       BIC    logLik  deviance  df.resid </span></span>
<span><span class="co">#&gt;  977.4705  989.3497 -484.7352  969.4705       140 </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups      Name        Std.Dev.</span></span>
<span><span class="co">#&gt;  Participant (Intercept) 11.287  </span></span>
<span><span class="co">#&gt;  Residual                 3.024  </span></span>
<span><span class="co">#&gt; Number of obs: 144, groups:  Participant, 72</span></span>
<span><span class="co">#&gt; Fixed Effects:</span></span>
<span><span class="co">#&gt; (Intercept)          Age  </span></span>
<span><span class="co">#&gt;    163.7090      -0.5533</span></span>
<span></span>
<span><span class="co">#Parameter Confidence Intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">null.vol</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing profile confidence intervals ...</span></span>
<span><span class="co">#&gt;                   2.5 %      97.5 %</span></span>
<span><span class="co">#&gt; .sig01        9.5208850  13.6036847</span></span>
<span><span class="co">#&gt; .sigma        2.5713387   3.6236647</span></span>
<span><span class="co">#&gt; (Intercept) 155.1479333 172.3796868</span></span>
<span><span class="co">#&gt; Age          -0.7016833  -0.4056009</span></span>
<span></span>
<span><span class="co">#Model fitted values and confidence intervals for each participant (L1 effects)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">9999</span><span class="op">)</span></span>
<span><span class="va">L1.predict.raz</span> <span class="op">&lt;-</span> <span class="fu">predictInterval</span><span class="op">(</span><span class="va">null.vol</span>, newdata <span class="op">=</span> <span class="va">raz2005</span>, n.sims <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">L1.predict.raz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">raz2005</span><span class="op">$</span><span class="va">Participant</span>, <span class="va">L1.predict.raz</span><span class="op">)</span></span>
<span></span>
<span><span class="va">theme_minimal</span> <span class="op">=</span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">theme</span><span class="op">(</span></span>
<span>                  legend.position<span class="op">=</span><span class="st">"none"</span>,</span>
<span>                  axis.line.x <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>                  axis.line.y <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>                  axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                  axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>, </span>
<span>                  axis.title.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                  axis.title.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>                  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#Create custom color palette </span></span>
<span><span class="co"># Blues&lt;-brewer.pal(9,"Blues")</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">raz2005</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Age</span>, y <span class="op">=</span> <span class="va">Volume</span>, group <span class="op">=</span> <span class="va">Participant</span>, color <span class="op">=</span> <span class="va">Participant</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">null.vol</span><span class="op">)</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">brainvolage.rmc</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">L1.predict.raz</span><span class="op">$</span><span class="va">lwr</span>,</span>
<span>                  ymax <span class="op">=</span> <span class="va">L1.predict.raz</span><span class="op">$</span><span class="va">upr</span>,</span>
<span>                  group <span class="op">=</span> <span class="va">L1.predict.raz</span><span class="op">$</span><span class="va">`raz2005$Participant`</span>,</span>
<span>                  linetype <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.07</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">theme_minimal</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Rmcorr and Random Intercept Multilevel Model:\n Raz et al. 2005 Data"</span>, x <span class="op">=</span> <span class="st">"Age"</span>, </span>
<span>       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Cerebellar</span><span class="op">~</span><span class="va">Hemisphere</span><span class="op">~</span><span class="va">Volume</span><span class="op">~</span><span class="op">(</span><span class="va">cm</span><span class="op">^</span><span class="op">{</span><span class="fl">3</span><span class="op">}</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="va">Participant</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_colour_gradientn</span><span class="op">(</span>colours<span class="op">=</span><span class="fu">kelly</span><span class="op">(</span><span class="fl">22</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fu">fixef</span><span class="op">(</span><span class="va">null.vol</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, slope <span class="op">=</span> <span class="fu">fixef</span><span class="op">(</span><span class="va">null.vol</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, colour <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></code></pre></div>
<p><img src="New_rmcorr_paper_analyses_figures_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Appendix C, Figure 1: Dots are actual data values, with color indicating participant. Solid</span></span>
<span><span class="co">#colored lines show the rmcorr model fit. The multilevel model fit is indicated by the dashed</span></span>
<span><span class="co">#colored lines for Level 1 (participant) effects and the dashed black line for Level 2 (experiment)</span></span>
<span><span class="co">#effects. The shaded areas are 95% confidence intervals for Level 1 effects. Note the models</span></span>
<span><span class="co">#clearly overlap, despite the absence of confidence intervals for rmcorr. </span></span>
<span></span>
<span><span class="co">#Converted to EPS file using Acrobat Pro b/c EPS doesn't support transparency</span></span>
<span><span class="co">#ggsave(file = "plots/AppendixC_Figure1.pdf", width = 5.70 , height = 5.73, dpi = 300)</span></span>
<span><span class="co">#dev.off()</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Rmcorr and multilevel model with Gilden et al. 2010 data</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vissearch.rmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmcorr.html">rmcorr</a></span><span class="op">(</span>participant <span class="op">=</span> <span class="va">sub</span>, measure1 <span class="op">=</span> <span class="va">rt</span>, measure2 <span class="op">=</span> <span class="va">acc</span>, dataset <span class="op">=</span> <span class="va">gilden2010</span><span class="op">)</span></span>
<span></span>
<span><span class="va">null.vis</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">acc</span> <span class="op">~</span> <span class="va">rt</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">sub</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">gilden2010</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Model 1: Random intercept + random slope for RT</span></span>
<span><span class="va">model1.vis</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">acc</span> <span class="op">~</span> <span class="va">rt</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">rt</span> <span class="op">|</span> <span class="va">sub</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">gilden2010</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; boundary (singular) fit: see help('isSingular')</span></span>
<span></span>
<span><span class="co">#Model Comparison</span></span>
<span><span class="co">#a) Chi-Square</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">null.vis</span>, <span class="va">model1.vis</span><span class="op">)</span></span>
<span><span class="co">#&gt; Data: gilden2010</span></span>
<span><span class="co">#&gt; Models:</span></span>
<span><span class="co">#&gt; null.vis: acc ~ rt + (1 | sub)</span></span>
<span><span class="co">#&gt; model1.vis: acc ~ rt + (1 + rt | sub)</span></span>
<span><span class="co">#&gt;            npar     AIC     BIC logLik deviance  Chisq Df Pr(&gt;Chisq)</span></span>
<span><span class="co">#&gt; null.vis      4 -197.41 -190.27 102.70  -205.41                     </span></span>
<span><span class="co">#&gt; model1.vis    6 -193.46 -182.75 102.73  -205.46 0.0497  2     0.9754</span></span>
<span></span>
<span><span class="co">#b) Evidence ratio using AIC</span></span>
<span><span class="va">Models.vis</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">Models.vis</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">null.vis</span>, <span class="va">model1.vis</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"AICcmodavg"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">ModelTable2</span><span class="op">&lt;-</span><span class="fu">aictab</span><span class="op">(</span><span class="va">Models.vis</span>, modnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"null"</span>, <span class="st">"Model 1"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">ModelTable2</span></span>
<span>  <span class="fu">evidence</span><span class="op">(</span><span class="va">ModelTable2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Evidence ratio between models 'null' and 'Model 1':</span></span>
<span><span class="co">#&gt; 13.43</span></span>
<span></span>
<span><span class="co">#Estimating and graphing null model </span></span>
<span><span class="co">#Parameter Confidence Intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">null.vis</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing profile confidence intervals ...</span></span>
<span><span class="co">#&gt;                   2.5 %     97.5 %</span></span>
<span><span class="co">#&gt; .sig01       0.02138120 0.05796124</span></span>
<span><span class="co">#&gt; .sigma       0.01294851 0.02139924</span></span>
<span><span class="co">#&gt; (Intercept)  0.91815424 1.05718722</span></span>
<span><span class="co">#&gt; rt          -0.15404840 0.02955915</span></span>
<span></span>
<span><span class="co">#Model fitted values and confidence intervals for each participant (L1 effects)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">9999</span><span class="op">)</span></span>
<span><span class="va">L1.predict.gilden</span> <span class="op">&lt;-</span> <span class="fu">predictInterval</span><span class="op">(</span><span class="va">null.vis</span>, newdata <span class="op">=</span> <span class="va">gilden2010</span>, n.sims <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">L1.predict.gilden</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">gilden2010</span><span class="op">$</span><span class="va">sub</span>, <span class="va">L1.predict.gilden</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">theme_minimal</span> <span class="op">=</span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">theme</span><span class="op">(</span></span>
<span>                  legend.position<span class="op">=</span><span class="st">"none"</span>,</span>
<span>                  axis.line.x <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>                  axis.line.y <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>                  axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                  axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>, </span>
<span>                  axis.title.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                  axis.title.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>                  <span class="op">)</span></span>
<span></span>
<span><span class="co">#Create custom color palette </span></span>
<span><span class="va">Colors12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">12</span>,<span class="st">"Paired"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">gilden2010</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, y <span class="op">=</span> <span class="va">acc</span>, group <span class="op">=</span> <span class="va">sub</span>, color <span class="op">=</span> <span class="va">sub</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">null.vis</span><span class="op">)</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">vissearch.rmc</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">L1.predict.gilden</span><span class="op">$</span><span class="va">lwr</span>,</span>
<span>                  ymax <span class="op">=</span> <span class="va">L1.predict.gilden</span><span class="op">$</span><span class="va">upr</span>,</span>
<span>                  group <span class="op">=</span> <span class="va">L1.predict.gilden</span><span class="op">$</span><span class="va">`gilden2010$sub`</span>,</span>
<span>                  linetype <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.07</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">theme_minimal</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Rmcorr and Random Intercept Multilevel Model:\n Gilden et al. 2010 Data"</span>, x <span class="op">=</span> <span class="st">"Response Time (Seconds)"</span>, y <span class="op">=</span> <span class="st">"Accuracy"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="va">sub</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_colour_gradientn</span><span class="op">(</span>colours<span class="op">=</span><span class="va">Colors12</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fu">fixef</span><span class="op">(</span><span class="va">null.vis</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, slope <span class="op">=</span> <span class="fu">fixef</span><span class="op">(</span><span class="va">null.vis</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, colour <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.80</span>, <span class="fl">1.0</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="New_rmcorr_paper_analyses_figures_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Converted to EPS file using Acrobat Pro b/c EPS doesn't support transparency</span></span>
<span></span>
<span><span class="co">#Appendix C, Figure 2: Dots are actual data values, with color indicating participant. Solid</span></span>
<span><span class="co">#colored lines show the rmcorr model fit. The multilevel model fit is indicated by the dashed</span></span>
<span><span class="co">#colored lines for Level 1 (participant) effects and the dashed black line for Level 2 (experiment)</span></span>
<span><span class="co">#effects. The shaded areas are 95% confidence intervals for Level 1 effects. Note the models</span></span>
<span><span class="co">#clearly overlap, despite the absence of confidence intervals for rmcorr. </span></span>
<span><span class="co">#ggsave(file = "plots/AppendixC_Figure2.pdf", width = 6.5 , height = 6.5, dpi = 300)</span></span>
<span></span>
<span></span>
<span><span class="co">#Estimating CIs: Convergence problems with model 1</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">model1.vis</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing profile confidence intervals ...</span></span>
<span><span class="co">#&gt;                   2.5 %     97.5 %</span></span>
<span><span class="co">#&gt; .sig01       0.02197527 0.11293808</span></span>
<span><span class="co">#&gt; .sig02      -1.00000000 1.00000000</span></span>
<span><span class="co">#&gt; .sig03       0.00000000        Inf</span></span>
<span><span class="co">#&gt; .sigma       0.01303108 0.02157782</span></span>
<span><span class="co">#&gt; (Intercept)  0.91458725 1.06378202</span></span>
<span><span class="co">#&gt; rt          -0.15425292 0.03364490</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/warnings.html" class="external-link">warnings</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">9999</span><span class="op">)</span></span>
<span>  <span class="fu">predictInterval</span><span class="op">(</span><span class="va">model1.vis</span>, newdata <span class="op">=</span> <span class="va">gilden2010</span>, n.sims <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#&gt;          fit       upr       lwr</span></span>
<span><span class="co">#&gt; 1  0.8663920 0.8960908 0.8352832</span></span>
<span><span class="co">#&gt; 2  0.8683327 0.8992494 0.8385416</span></span>
<span><span class="co">#&gt; 3  0.8707389 0.8997923 0.8393785</span></span>
<span><span class="co">#&gt; 4  0.8725921 0.9043416 0.8411908</span></span>
<span><span class="co">#&gt; 5  0.9429413 0.9732029 0.9159473</span></span>
<span><span class="co">#&gt; 6  0.9432319 0.9722811 0.9162444</span></span>
<span><span class="co">#&gt; 7  0.9500212 0.9787765 0.9220920</span></span>
<span><span class="co">#&gt; 8  0.9521220 0.9792167 0.9237837</span></span>
<span><span class="co">#&gt; 9  0.9481541 0.9752953 0.9207015</span></span>
<span><span class="co">#&gt; 10 0.9557798 0.9844996 0.9267692</span></span>
<span><span class="co">#&gt; 11 0.9559257 0.9853144 0.9268080</span></span>
<span><span class="co">#&gt; 12 0.9596370 0.9887583 0.9285575</span></span>
<span><span class="co">#&gt; 13 0.9443758 0.9730895 0.9144351</span></span>
<span><span class="co">#&gt; 14 0.9430301 0.9705867 0.9121712</span></span>
<span><span class="co">#&gt; 15 0.9481910 0.9777425 0.9189827</span></span>
<span><span class="co">#&gt; 16 0.9500669 0.9785099 0.9180516</span></span>
<span><span class="co">#&gt; 17 0.9546490 0.9828561 0.9234057</span></span>
<span><span class="co">#&gt; 18 0.9511326 0.9826628 0.9211205</span></span>
<span><span class="co">#&gt; 19 0.9583308 0.9867742 0.9280774</span></span>
<span><span class="co">#&gt; 20 0.9601212 0.9901520 0.9312060</span></span>
<span><span class="co">#&gt; 21 0.9227967 0.9488316 0.8935664</span></span>
<span><span class="co">#&gt; 22 0.9244902 0.9553428 0.8959148</span></span>
<span><span class="co">#&gt; 23 0.9277636 0.9569939 0.8986043</span></span>
<span><span class="co">#&gt; 24 0.9300477 0.9599092 0.9000850</span></span>
<span><span class="co">#&gt; 25 0.9625122 0.9928161 0.9347764</span></span>
<span><span class="co">#&gt; 26 0.9680937 0.9978023 0.9390449</span></span>
<span><span class="co">#&gt; 27 0.9706817 1.0010774 0.9416283</span></span>
<span><span class="co">#&gt; 28 0.9749069 1.0033890 0.9446229</span></span>
<span><span class="co">#&gt; 29 0.9337347 0.9613853 0.9051130</span></span>
<span><span class="co">#&gt; 30 0.9427611 0.9688831 0.9133651</span></span>
<span><span class="co">#&gt; 31 0.9495472 0.9767039 0.9189270</span></span>
<span><span class="co">#&gt; 32 0.9506709 0.9813415 0.9226078</span></span>
<span><span class="co">#&gt; 33 0.9092402 0.9374052 0.8801574</span></span>
<span><span class="co">#&gt; 34 0.9081569 0.9380428 0.8783812</span></span>
<span><span class="co">#&gt; 35 0.9101271 0.9393227 0.8784178</span></span>
<span><span class="co">#&gt; 36 0.9130451 0.9411345 0.8840515</span></span>
<span><span class="co">#&gt; 37 0.9530667 0.9841683 0.9233226</span></span>
<span><span class="co">#&gt; 38 0.9633384 0.9921144 0.9363187</span></span>
<span><span class="co">#&gt; 39 0.9616431 0.9909585 0.9335434</span></span>
<span><span class="co">#&gt; 40 0.9655959 0.9935503 0.9362402</span></span>
<span><span class="co">#&gt; 41 0.9739775 1.0029519 0.9440092</span></span>
<span><span class="co">#&gt; 42 0.9725509 1.0019449 0.9447089</span></span>
<span><span class="co">#&gt; 43 0.9767107 1.0060772 0.9455765</span></span>
<span><span class="co">#&gt; 44 0.9756523 1.0049782 0.9452859</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/warnings.html" class="external-link">warnings</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="diagnostic-plot-rmcorr-and-straight-lines-between-points-not-in-paper">Diagnostic Plot: Rmcorr and straight lines between points (not in
paper)<a class="anchor" aria-label="anchor" href="#diagnostic-plot-rmcorr-and-straight-lines-between-points-not-in-paper"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brainvolage.rmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmcorr.html">rmcorr</a></span><span class="op">(</span>participant <span class="op">=</span> <span class="va">Participant</span>, measure1 <span class="op">=</span> <span class="va">Age</span>, measure2 <span class="op">=</span> <span class="va">Volume</span>, dataset <span class="op">=</span> <span class="va">raz2005</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in rmcorr(participant = Participant, measure1 = Age, measure2 =</span></span>
<span><span class="co">#&gt; Volume, : 'Participant' coerced into a factor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">brainvolage.rmc</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Repeated measures correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; r</span></span>
<span><span class="co">#&gt; -0.7044077</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; degrees of freedom</span></span>
<span><span class="co">#&gt; 71</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; p-value</span></span>
<span><span class="co">#&gt; 3.561007e-12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 95% confidence interval</span></span>
<span><span class="co">#&gt; -0.8053581 -0.5637514</span></span>
<span></span>
<span><span class="va">theme_minimal</span> <span class="op">=</span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">theme</span><span class="op">(</span></span>
<span>                  legend.position<span class="op">=</span><span class="st">"none"</span>,</span>
<span>                  axis.line.x <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>                  axis.line.y <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>                  axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                  axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>, </span>
<span>                  axis.title.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                  axis.title.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>                  <span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">raz2005</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Age</span>, y <span class="op">=</span> <span class="va">Volume</span>, group <span class="op">=</span> <span class="va">Participant</span>, color <span class="op">=</span> <span class="va">Participant</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">brainvolage.rmc</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">theme_minimal</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Rmcorr and Diagnostic Lines:\n Raz et al. 2005 Data"</span>, x <span class="op">=</span> <span class="st">"Age"</span>, </span>
<span>       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Cerebellar</span><span class="op">~</span><span class="va">Hemisphere</span><span class="op">~</span><span class="va">Volume</span><span class="op">~</span><span class="op">(</span><span class="va">cm</span><span class="op">^</span><span class="op">{</span><span class="fl">3</span><span class="op">}</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="va">Participant</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_colour_gradientn</span><span class="op">(</span>colours<span class="op">=</span><span class="fu">kelly</span><span class="op">(</span><span class="fl">22</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span>linetype <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="New_rmcorr_paper_analyses_figures_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#ggsave(file = "plots/Figure_rmcorr_diagnostic.pdf", width = 5.70 , height = 5.73, dpi = 300)</span></span>
<span><span class="co">#ggsave(file = "plots/Figure_rmcorr_diagnostic.eps", width = 5.70 , height = 5.73, dpi = 300)</span></span>
<span><span class="co">#dev.off()</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jonathan Z. Bakdash, Laura R. Marusich.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
