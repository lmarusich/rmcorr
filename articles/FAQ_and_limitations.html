<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Frequently Asked Questions and Limitations • rmcorr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Frequently Asked Questions and Limitations">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rmcorr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/FAQ_and_limitations.html">Frequently Asked Questions and Limitations</a></li>
    <li><a class="dropdown-item" href="../articles/New_rmcorr_paper_analyses_figures.html">Reproduce Paper Results</a></li>
    <li><a class="dropdown-item" href="../articles/CI_fix.html">Confidence Interval Fix</a></li>
    <li><a class="dropdown-item" href="../articles/repro_bootstrapping.html">Bootstrapping Example</a></li>
    <li><a class="dropdown-item" href="../articles/compcor.html">Comparing Correlations</a></li>
    <li><a class="dropdown-item" href="../articles/rmcorr_mat.html">Correlation Matrix using rmcorr_mat</a></li>
    <li><a class="dropdown-item" href="../articles/model_diag.html">Diagnostic Plots</a></li>
    <li><a class="dropdown-item" href="../articles/estimates_w_NaN.html">rmcorr Estimates with NaN</a></li>
    <li><a class="dropdown-item" href="../articles/overfitting.html">Overfitting/Pseudoreplication</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lmarusich/rmcorr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Frequently Asked Questions and Limitations</h1>
                        <h4 data-toc-skip class="author">Jonathan
Bakdash and Laura Marusich</h4>
            
            <h4 data-toc-skip class="date">2024-07-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/lmarusich/rmcorr/blob/master/vignettes/FAQ_and_limitations.Rmd" class="external-link"><code>vignettes/FAQ_and_limitations.Rmd</code></a></small>
      <div class="d-none name"><code>FAQ_and_limitations.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="frequently-asked-questions">Frequently Asked Questions<a class="anchor" aria-label="anchor" href="#frequently-asked-questions"></a>
</h2>
<div class="section level3">
<h3 id="how-to-calculate-power">How to Calculate Power<a class="anchor" aria-label="anchor" href="#how-to-calculate-power"></a>
</h3>
<p>Power can be calculated using the <em>power.rmcorr</em> function.
This function modifies pwr.r.test from the
<a href="https://CRAN.R-project.org/package=pwr" class="external-link">pwr</a> package to use
the rmcorr degrees of freedom. It is not presently included in the
rmcorr package.</p>
<p>Notation: <em>N</em> is the sample size, <em>k</em> is the (average)
number of repeated measures for each individual, and
<em>r</em><sub><em>rm</em></sub> is the rmcorr effect size.</p>
<div class="section level4">
<h4 id="power-rmcorr-example">power.rmcorr Example<a class="anchor" aria-label="anchor" href="#power-rmcorr-example"></a>
</h4>
<p><em>N</em> = 100, <em>k</em> = 3, and
<em>r</em><sub><em>rm</em></sub> = 0.20. This design has 82% power.</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pwr"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/heliosdrm/pwr" class="external-link">pwr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">power.rmcorr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">k</span>, <span class="va">N</span>, <span class="va">effectsizer</span>, <span class="va">sig</span><span class="op">)</span></span>
<span>    <span class="op">{</span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.r.test.html" class="external-link">pwr.r.test</a></span><span class="op">(</span>n <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>, r <span class="op">=</span> <span class="va">effectsizer</span>, sig.level <span class="op">=</span> <span class="va">sig</span><span class="op">)</span><span class="op">}</span></span>
<span>    </span>
<span><span class="fu">power.rmcorr</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, N <span class="op">=</span> <span class="fl">100</span>, effectsizer <span class="op">=</span> <span class="fl">0.20</span>, sig <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>    </span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      approximate correlation power calculation (arctangh transformation) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               n = 201</span></span>
<span><span class="co">#&gt;               r = 0.2</span></span>
<span><span class="co">#&gt;       sig.level = 0.05</span></span>
<span><span class="co">#&gt;           power = 0.8156984</span></span>
<span><span class="co">#&gt;     alternative = two.sided</span></span></code></pre>
<p>See <a href="./New_rmcorr_paper_analyses_figures.html#power">Power
curves</a> for more information.</p>
<p>For G*Power <span class="citation">(Faul et al. 2009)</span> or other
software, power can be calculated by substituting the rmcorr degrees of
freedom for a Pearson correlation. Instead of sample size, use the
degrees of freedom for rmcorr plus two (effective sample size). This is
because a Pearson correlation has <em>N</em> - 2 degrees of
freedom.<br></p>
<ul>
<li>Rmcorr exact degrees of freedom = <em>N</em> x (<em>k</em> - 1) - 1
<br>
</li>
<li>Approximate degrees of freedom = (<em>N</em> -1) x (<em>k</em> - 1)
<br>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="exact-degrees-of-freedom-example">Exact Degrees of Freedom Example<a class="anchor" aria-label="anchor" href="#exact-degrees-of-freedom-example"></a>
</h4>
<p>Values: <em>N</em> = 100, <em>k</em> = 3 , and
<em>r</em><sub><em>rm</em></sub> = 0.20 (same as above) <br> rmcorr df =
100 x (3 - 1) - 1 = 200 - 1 = 199 <br> Add two (kludge): 199 + 2 = 201
<br> Enter <em>N</em> = 201 as the effective sample size in G*Power <br>
G*Power will calculate the degrees of freedom as <em>N</em> - 2 = 201 -
2 = 199. Thus, using the correct degrees of freedom for rmcorr. <br></p>
<p><em>Note</em> power is just slighty different than the same
calculation in R, which uses an arctan approximation.</p>
<div class="float">
<img src="../reference/figures/Gpower_exact_df.jpg" alt="G*Power using the exact degrees of freedom"><div class="figcaption">G*Power using the exact degrees of freedom</div>
</div>
</div>
<div class="section level4">
<h4 id="approximate-degrees-of-freedom-example">Approximate Degrees of Freedom Example<a class="anchor" aria-label="anchor" href="#approximate-degrees-of-freedom-example"></a>
</h4>
<p>Values: <em>N</em> = 100, <em>k</em> = 3, and
<em>r</em><sub><em>rm</em></sub> = 0.20 (again, same as above) <br>
approx rmcorr df = (100 - 1) x (3 - 1) = 99 x 2 = 198 <br> Note the
small difference between the approximate vs. exact calculation:
<em>one</em> degree of freedom <br> Add two (same kludge) for G*Power,
entering a sample size of <em>N</em> = 200 <br></p>
<p><em>Note</em> power is slighty different than the exact formula
above. <img src="../reference/figures/Gpower_approx_df.jpg" alt="G*Power using the approx degrees of freedom"></p>
</div>
</div>
<div class="section level3">
<h3 id="how-to-extract-the-slope-and-its-confidence-interval">How to Extract the Slope and its Confidence Interval<a class="anchor" aria-label="anchor" href="#how-to-extract-the-slope-and-its-confidence-interval"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my.rmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmcorr.html">rmcorr</a></span><span class="op">(</span>participant <span class="op">=</span> <span class="va">Subject</span>, measure1 <span class="op">=</span> <span class="va">PaCO2</span>, measure2 <span class="op">=</span> <span class="va">pH</span>, </span>
<span>                 dataset <span class="op">=</span> <span class="va">bland1995</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in rmcorr(participant = Subject, measure1 = PaCO2, measure2 = pH, :</span></span>
<span><span class="co">#&gt; 'Subject' coerced into a factor</span></span>
<span> </span>
<span><span class="co"># Structure of rmcorr object</span></span>
<span><span class="co">#str(my.rmc)</span></span>
<span> </span>
<span><span class="co"># Extract rmcorr model coefficients</span></span>
<span><span class="va">coef.rmc</span>  <span class="op">&lt;-</span> <span class="va">my.rmc</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="va">coefficients</span></span>
<span><span class="va">coef.rmc</span></span>
<span><span class="co">#&gt;  (Intercept) Participant1 Participant2 Participant3 Participant4 Participant5 </span></span>
<span><span class="co">#&gt;   7.65590848  -0.72605418  -0.02144291   0.22395850   0.24550355   0.13432752 </span></span>
<span><span class="co">#&gt; Participant6 Participant7     Measure1 </span></span>
<span><span class="co">#&gt;   0.20037424  -0.03394863  -0.10832305</span></span>
<span> </span>
<span><span class="va">slope.rmc</span> <span class="op">&lt;-</span> <span class="va">coef.rmc</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">coef.rmc</span><span class="op">)</span><span class="op">]</span> <span class="co">#Last value in coefficients is the slope</span></span>
<span><span class="va">slope.rmc</span></span>
<span><span class="co">#&gt;  Measure1 </span></span>
<span><span class="co">#&gt; -0.108323</span></span>
<span> </span>
<span><span class="co"># Confidence intervals around all estimates</span></span>
<span><span class="va">coef.CIs</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">my.rmc</span><span class="op">$</span><span class="va">model</span><span class="op">)</span> </span>
<span><span class="va">coefs.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">coef.rmc</span>, <span class="va">coef.CIs</span><span class="op">)</span></span>
<span><span class="va">coefs.all</span></span>
<span><span class="co">#&gt;                 coef.rmc       2.5 %      97.5 %</span></span>
<span><span class="co">#&gt; (Intercept)   7.65590848  7.34994594  7.96187102</span></span>
<span><span class="co">#&gt; Participant1 -0.72605418 -0.83211999 -0.61998837</span></span>
<span><span class="co">#&gt; Participant2 -0.02144291 -0.11116705  0.06828123</span></span>
<span><span class="co">#&gt; Participant3  0.22395850  0.16049969  0.28741732</span></span>
<span><span class="co">#&gt; Participant4  0.24550355  0.16448903  0.32651806</span></span>
<span><span class="co">#&gt; Participant5  0.13432752  0.05868538  0.20996967</span></span>
<span><span class="co">#&gt; Participant6  0.20037424  0.12673292  0.27401556</span></span>
<span><span class="co">#&gt; Participant7 -0.03394863 -0.17148111  0.10358385</span></span>
<span><span class="co">#&gt; Measure1     -0.10832305 -0.16883787 -0.04780822</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="isa-error">isa Error<a class="anchor" aria-label="anchor" href="#isa-error"></a>
</h3>
<p>We have had reports of this error when running rmcorr: <br></p>
<pre><code>Error in isa(Participant, "character") : could not find function "isa" </code></pre>
<p><a href="https://stackoverflow.com/questions/73146762/how-to-solve-the-following-error-running-rmcorr-in-r-error-in-isaparticipant" class="external-link">Stack
Question with error</a></p>
<p>Updating R to version 4.1.0 or later resolves this error. <br></p>
</div>
<div class="section level3">
<h3 id="transformations">Transformations<a class="anchor" aria-label="anchor" href="#transformations"></a>
</h3>
<p>Transformations can be used to make the data (errors) more normal. We
highly recommend graphing both the raw and transformed data. It may be
appropriate to only transform one measure or transform both measures.
“Consider transforming every variable in sight” <span class="citation">(Gelman and Hill 2007, 548)</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h2>
<div class="section level3">
<h3 id="change-over-time">Change Over Time<a class="anchor" aria-label="anchor" href="#change-over-time"></a>
</h3>
<p>In general, rmcorr is a time-independent model– it does not model
change over time. A partial exception is if time is a measure, such as
age in the raz2005 dataset. <br></p>
</div>
<div class="section level3">
<h3 id="non-linearity">Non-Linearity<a class="anchor" aria-label="anchor" href="#non-linearity"></a>
</h3>
<p>Rmcorr fits a linear model. If the data are non-linear, we recommend
trying to transform it (see above) or using multilevel modeling. Also
see <a href="./model_diag.html">Diagnostic Plots</a></p>
</div>
<div class="section level3">
<h3 id="varying-slopes-with-influential-observations-andor-unbalanced-data">Varying Slopes with Influential Observations and/or Unbalanced
Data<a class="anchor" aria-label="anchor" href="#varying-slopes-with-influential-observations-andor-unbalanced-data"></a>
</h3>
<p>If slopes meaningfully vary by individual, we recommend using
multilevel modeling instead of rmcorr. Random effect slopes are even
more problematic for rmcorr with influential observations and/or highly
unbalanced data. This is nicely illustrated in simulations by Dr. Marta
Karas: <br><a href="https://martakarass.github.io/post/2022-04-27-rmcorr_vs_lmm/" class="external-link">When
rmcorr may not be ideal</a></p>
</div>
</div>
<div class="section level2">
<h2 id="other-implementations-of-rmcorr">Other Implementations of rmcorr<a class="anchor" aria-label="anchor" href="#other-implementations-of-rmcorr"></a>
</h2>
<p>We know of three other implementations of rmcorr.</p>
<div class="section level3">
<h3 id="rmcorrshiny-web-and-standalone-app-with-a-graphical-interface-marusich2021rmcorrshiny">1) rmcorrShiny: Web and Standalone App with a Graphical Interface
<span class="citation">(Marusich and Bakdash 2021)</span><a class="anchor" aria-label="anchor" href="#rmcorrshiny-web-and-standalone-app-with-a-graphical-interface-marusich2021rmcorrshiny"></a>
</h3>
<ul>
<li><a href="https://lmarusich.shinyapps.io/shiny_rmcorr/" class="external-link">Web
App</a></li>
<li><a href="https://github.com/lmarusich/rmcorrShiny" class="external-link">Shiny Source Code
and Running the Standalone App</a></li>
</ul>
</div>
<div class="section level3">
<h3 id="python-rm_corr-in-pingouin-vallat2018pingouin">2) Python: rm_corr in Pingouin <span class="citation">(Vallat
2018)</span><a class="anchor" aria-label="anchor" href="#python-rm_corr-in-pingouin-vallat2018pingouin"></a>
</h3>
<ul>
<li><a href="https://pingouin-stats.org/generated/pingouin.rm_corr.html#pingouin.rm_corr" class="external-link">rm_corr</a></li>
</ul>
</div>
<div class="section level3">
<h3 id="stata-rmcorr-stata-rmcorr">3) Stata: RMCORR <span class="citation">(Linden 2021)</span><a class="anchor" aria-label="anchor" href="#stata-rmcorr-stata-rmcorr"></a>
</h3>
<ul>
<li><a href="https://ideas.repec.org/c/boc/bocode/s458971.html" class="external-link">RMCORR</a></li>
</ul>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-faul_statistical_2009" class="csl-entry">
Faul, Franz, Edgar Erdfelder, Axel Buchner, and Albert-Georg Lang. 2009.
<span>“Statistical Power Analyses Using
<span>G</span>*<span>Power</span> 3.1: <span>Tests</span> for
Correlation and Regression Analyses.”</span> <em>Behavior Research
Methods</em> 41 (4): 1149–60. <a href="https://doi.org/10.3758/BRM.41.4.1149" class="external-link">https://doi.org/10.3758/BRM.41.4.1149</a>.
</div>
<div id="ref-gelman2007" class="csl-entry">
Gelman, Andrew, and Jennifer Hill. 2007. <em>Data Analysis Using
Regression and Multilevel/Hierarchical Models</em>. Cambridge University
Press.
</div>
<div id="ref-stata.rmcorr" class="csl-entry">
Linden, Ariel. 2021. <span>“<span class="nocase">RMCORR: Stata module to
compute a correlation for data with repeated measures</span>.”</span>
Statistical Software Components, Boston College Department of Economics.
<a href="https://ideas.repec.org/c/boc/bocode/s458971.html" class="external-link">https://ideas.repec.org/c/boc/bocode/s458971.html</a>.
</div>
<div id="ref-marusich2021rmcorrshiny" class="csl-entry">
Marusich, Laura R, and Jonathan Z Bakdash. 2021. <span>“rmcorrShiny: A
Web and Standalone Application for Repeated Measures
Correlation.”</span> <em>F1000Research</em> 10: 697. <a href="https://doi.org/10.12688/f1000research.55027.2" class="external-link">https://doi.org/10.12688/f1000research.55027.2</a>.
</div>
<div id="ref-vallat2018pingouin" class="csl-entry">
Vallat, Raphael. 2018. <span>“Pingouin: Statistics in Python.”</span>
<em>J. Open Source Softw.</em> 3 (31): 1026. <a href="https://doi.org/10.21105/joss.01026" class="external-link">https://doi.org/10.21105/joss.01026</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonathan Z. Bakdash, Laura R. Marusich.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
