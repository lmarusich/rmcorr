{
    "collab_server" : "",
    "contents" : "---\ntitle: 'Rmcorr: Appendix C'\nauthor: \"Jon Bakdash and Laura Marusich\"\ndate: \"December 15, 2016\"\noutput: html_document\n---\n\n```{r setup, include = FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n##### Load libraries\n```{r, echo = FALSE}\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(rmcorr, lme4, AICcmodavg, ggplot2, RColorBrewer, merTools)\n\nrequire(rmcorr)\nrequire(lme4)\nrequire(AICcmodavg)\nrequire(ggplot2)\nrequire(RColorBrewer)\nrequire(merTools)\n```\n\n1. Rmcorr and multi-level model with Raz et al. 2005 data \n```{r, echo = TRUE}\nbrainvolage.rmc <- rmcorr(participant = Participant, measure1 = Age, measure2 = Volume, dataset = raz2005)\n\n#Null multi-level model: Random intercept and fixed slope\nnull.vol <- lmer(Volume ~ Age + (1 | Participant), data = raz2005, REML = FALSE)\n\n#Model fit\nnull.vol\n\n#Parameter Confidence Intervals\nconfint(null.vol)\n\n#Model fitted values and confidence intervals for each participant (L1 effects)\nset.seed(9999)\nL1.predict.raz <- predictInterval(null.vol, newdata = raz2005, n.sims = 1000)\nL1.predict.raz <- cbind(raz2005$Participant, L1.predict.raz)\n\napatheme =  theme_bw() +\n            theme(panel.grid.major=element_blank(),\n                  panel.grid.minor=element_blank(),\n                  panel.border=element_blank(),\n                  axis.line=element_line(),\n                  legend.position=\"none\",\n                  #text=element_text(family='Times'), #Need- https://github.com/wch/extrafont + Ghostscript\n                  #legend.title=element_blank(),\n                  axis.line.x = element_line(color=\"black\", size = 0.9),\n                  axis.line.y = element_line(color=\"black\", size = 0.9),\n                  axis.text.x = element_text(size = 12),\n                  axis.text.y = element_text(size = 12), \n                  axis.title.x = element_text(size = 12),\n                  axis.title.y = element_text(size = 12))\n\n#Create custom color palette \nBlues<-brewer.pal(9,\"Blues\")\n\nggplot(raz2005, aes(x = Age, y = Volume, group = Participant, color = Participant)) +\n  geom_line(aes(y = predict(null.vol)), linetype = 2) + \n  geom_line(aes(y = brainvolage.rmc$model$fitted.values), linetype = 1) + \n  geom_ribbon(aes(ymin = L1.predict.raz$lwr,\n                  ymax = L1.predict.raz$upr,\n                  group = L1.predict.raz$`raz2005$Participant`,\n                  linetype = NA), alpha = 0.07) +\n  apatheme + \n  labs(title = \"Rmcorr and Random Intercept Multi-Level Model:\\n Raz et al. 2005 Data\", x = \"Age\", \n       y = expression(Cerebellar~Hemisphere~Volume~(cm^{3}))) +\n  geom_point(aes(colour = Participant)) +\n  scale_colour_gradientn(colours=Blues) + theme(plot.title = element_text(hjust = 0.5)) + \n  geom_abline(intercept = fixef(null.vol)[1], slope = fixef(null.vol)[2], colour = \"black\", size = 1, linetype = 2)\n\nggsave(file = \"AppendixC_Figure1.pdf\", width = 5.70 , height = 5.73, dpi = 300)\n```\n\n2. Rmcorr and multi-level model with Gilden et al. 2010 data \n```{r, echo = TRUE}\nvissearch.rmc <- rmcorr(participant = sub, measure1 = rt, measure2 = acc, dataset = gilden2010)\n\nnull.vis <- lmer(acc ~ rt + (1 | sub), data = gilden2010, REML = FALSE)\n\n#Model 1: Random intercept + random slope for RT\nmodel1.vis <- lmer(acc ~ rt + (1 + rt | sub), data = gilden2010, REML = FALSE)\n\n#Model Comparison\n#a) Chi-Square\nanova(null.vis, model1.vis)\n\n#b) Evidence ratio using AIC\nModels.vis<-list()\nModels.vis<-c(null.vis, model1.vis)\n\nModelTable2<-aictab(Models.vis, modnames = c(\"null\", \"Model 1\"))\nModelTable2\nevidence(ModelTable2)\n\n  #Estimating CIs: Convergence problems with model 1\n  confint(model1.vis)\n  warnings()\n  \n  set.seed(9999)\n  predictInterval(model1.vis, newdata = gilden2010, n.sims = 1000)\n  warnings()\n\n#Estimating and graphing null model \n#Parameter Confidence Intervals\nconfint(null.vis)\n\n#Model fitted values and confidence intervals for each participant (L1 effects)\nset.seed(9999)\nL1.predict.gilden <- predictInterval(null.vis, newdata = gilden2010, n.sims = 1000)\nL1.predict.gilden <- cbind(gilden2010$sub, L1.predict.gilden)\n\napatheme =  theme_bw() +\n            theme(panel.grid.major=element_blank(),\n                  panel.grid.minor=element_blank(),\n                  panel.border=element_blank(),\n                  axis.line=element_line(),\n                  legend.position=\"none\",\n                  #text=element_text(family='Times'), #Need- https://github.com/wch/extrafont + Ghostscript\n                  #legend.title=element_blank(),\n                  axis.line.x = element_line(color=\"black\", size = 0.9),\n                  axis.line.y = element_line(color=\"black\", size = 0.9),\n                  axis.text.x = element_text(size = 12),\n                  axis.text.y = element_text(size = 12), \n                  axis.title.x = element_text(size = 12),\n                  axis.title.y = element_text(size = 12))\n\n#Create custom color palette \nColors12<-brewer.pal(12,\"Paired\")\n\nggplot(gilden2010, aes(x = rt, y = acc, group = sub, color = sub)) +\n  geom_line(aes(y = predict(null.vis)), linetype = 2) + \n  geom_line(aes(y = vissearch.rmc$model$fitted.values), linetype = 1) + \n  geom_ribbon(aes(ymin = L1.predict.gilden$lwr,\n                  ymax = L1.predict.gilden$upr,\n                  group = L1.predict.gilden$`gilden2010$sub`,\n                  linetype = NA),\n                  alpha = 0.07) +\n  apatheme + theme(plot.title = element_text(hjust = 0.5)) + \n  labs(title = \"Rmcorr and Random Intercept Multi-Level Model:\\n Gilden et al. 2010 Data\", x = \"Response Time (Seconds)\", y = \"Accuracy\") +\n  geom_point(aes(colour = sub)) +\n  scale_colour_gradientn(colours=Colors12) + \n  geom_abline(intercept = fixef(null.vis)[1], slope = fixef(null.vis)[2], colour = \"black\", size = 1, linetype = 2) +\n  \n  scale_y_continuous(breaks=seq(0.80, 1.0, 0.05)) +\n  scale_x_continuous(breaks=seq(0.50, 0.9, 0.1)) \n\nggsave(file = \"AppendixC_Figure2.pdf\", width = 5.70 , height = 5.73, dpi = 300)\n```\n",
    "created" : 1486388803246.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2036003759",
    "id" : "1FF1AC46",
    "lastKnownWriteTime" : 1486388812,
    "last_content_update" : 1486388812498,
    "path" : "~/Papers/Rmcorr 2015/rmcorr_Appendix_C.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}