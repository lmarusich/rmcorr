{
    "contents" : "#' Plot the repeated measures correlation coefficient.\n#' \n#' \\code{rmcplot}  produces a scatterplot of \\code{measure1} on the x-axis and \n#' \\code{measure2} on the y-axis, with a different color used for each subject.\n#' Parallel lines are fitted to each subject's data.\n#' \n#' @param participant a variable giving the subject name/id for each observation.\n#' @param measure1 a numeric variable giving the observations for one measure.\n#' @param measure2 a numeric variable giving the observations for the second measure.\n#' @param dataset the data frame containing the variables.\n#' @param overall logical: if TRUE, plots the regression line between measure1 and\n#' measure2, ignoring the participant variable.\n#' @param xlab label for the x axis, defaults to the variable name for measure1.\n#' @param ylab label for the y axis, defaults to the variable name for measure2.\n#' names for measure1 and measure2.\n#' @param ... additional arguments to \\code{\\link[graphics]{plot}}.\n#' @seealso \\code{\\link{rmcorr}}\n#' @examples\n#' ## Bland Altman 1995 data\n#' rmcplot(participant = Subject, measure1 = PacO2, measure2 = pH, \n#' dataset = bland1995, overall = TRUE)\n#' @export\n\nrmcplot <-function(participant, measure1, measure2, dataset, overall=F,\n                       xlab=NULL, ylab=NULL,...) \n{\n    ##what to do if spaces in col name?\n    \n    args <- as.list(match.call())\n    \n    Participant <- eval(args$participant, dataset)\n    if (!is.factor(Participant)) {\n        Participant <- factor(Participant)\n        warning (\"Participant coerced into a factor\")\n    }\n    \n    Measure1 <- eval(args$measure1, dataset)\n    Measure2 <- eval(args$measure2, dataset)\n    if (!is.numeric(Measure1) || !is.numeric(Measure2)) \n        stop (\"'Measure 1' and 'Measure 2' must be numeric\")\n    \n    lmmodel <- lm(Measure2 ~ Participant + Measure1)\n    lmslope <- coef(lmmodel)[\"Measure1\"]\n    preds <- predict(lmmodel)\n    \n    if (is.null(xlab)){\n        xlab <- args$measure1\n    }\n    if (is.null(ylab)){\n        ylab <- args$measure2\n    }\n    \n    set1 <- RColorBrewer::brewer.pal(12,'Paired')\n    pal <- colorRampPalette(set1)\n    colors <- pal(length(levels(Participant)))\n    plot(Measure1, Measure2, pch=16, col = colors[Participant], xlab=xlab,\n         ylab = ylab, ...)\n    \n    nsubs <- length(levels(Participant))\n    \n    for (i in 1:nsubs){\n        subindex <- which(Participant == levels(Participant)[i])\n        lines(Measure1[subindex], preds[subindex], col = colors[i])\n    }\n    \n    \n    if (overall) {\n        abline(lm(Measure2 ~ Measure1), col = \"gray60\", lwd = 3,lty = 2)\n    }\n}\n",
    "created" : 1432150410658.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "371020219",
    "id" : "41423B46",
    "lastKnownWriteTime" : 1437750702,
    "path" : "C:/Users/Laura Cooper/Desktop/Need from Laptop/rmcorr package/rmcorr/R/rmcplot.R",
    "project_path" : "R/rmcplot.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 0,
    "source_on_save" : false,
    "type" : "r_source"
}